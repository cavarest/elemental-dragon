services:
  minecraft:
    build:
      context: .
    image: dragon-egg-lightning:latest
    container_name: ${CONTAINER_NAME:-papermc-dragonegg}
    restart: unless-stopped
    ports:
      - "25565:25565"
      - "25575:25575"
    environment:
      # Base image environment variables
      - MEMORYSIZE=${MEMORYSIZE:-2G}
      - EULA=${EULA:-TRUE}
      - ONLINE_MODE=${ONLINE_MODE:-false}
      - MAX_PLAYERS=${MAX_PLAYERS:-10}
      - ADMIN_USERNAME=${ADMIN_USERNAME:-admin}
    volumes:
      # Persist all server data (including any custom worlds players may create)
      - ./server-data:/data:rw
      # Note: Plugins are baked into the Docker image, no need for separate volume mount
    stdin_open: true
    tty: true
    networks:
      - minecraft-network

networks:
  minecraft-network:
    driver: bridge
